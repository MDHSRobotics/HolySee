package team4141.robotvision.msee;

import java.io.IOException;
import java.net.InetAddress;
import java.net.UnknownHostException;

import javax.jmdns.JmDNS;
import javax.jmdns.ServiceEvent;
import javax.jmdns.ServiceListener;

public class DNSSDListener implements ServiceListener, Runnable{
	
	public DNSSDListener() {
		System.out.print("DNSSDListener instantiated");
	}

	public void serviceAdded(ServiceEvent event) {
		System.out.println("service added:");
		System.out.println(event.getName());
		System.out.println(event.getType());
		System.out.println(event.getInfo().getURLs());
	}

	public void serviceRemoved(ServiceEvent event) {
		System.out.println("service removed:");
		System.out.println(event.getName());
		System.out.println(event.getType());
		System.out.println(event.getInfo().getURLs());
		
	}

	public void serviceResolved(ServiceEvent event) {
		System.out.println("service resolved:");
		System.out.println(event.getName());
		System.out.println(event.getType());
		System.out.println(event.getInfo().getURLs());
		
	}

	public void run() {
		System.out.print("DNSSDListener run");
		try {
            // Create a JmDNS instance
            JmDNS jmdns = JmDNS.create(InetAddress.getLocalHost());

            // Add a service listener
            jmdns.addServiceListener("_tcp.local.", new DNSSDListener());

            // Wait a bit
            Thread.sleep(30000);
        } catch (UnknownHostException e) {
            System.out.println(e.getMessage());
        } catch (IOException e) {
            System.out.println(e.getMessage());
        } catch (InterruptedException e) {
        	System.out.println(e.getMessage());
		}
		
	}

}
